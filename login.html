<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description"
        content="Login to your EWU Matrimony account and continue your journey to find your perfect match from East West University.">
    <title>Login - EWU Matrimony</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Outfit:wght@500;600;700;800&display=swap"
        rel="stylesheet">

    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="theme.css">
    <link rel="stylesheet" href="animations.css">
    <link rel="stylesheet" href="components.css">
    <link rel="stylesheet" href="pages.css">
    <link rel="stylesheet" href="icons.css">
</head>

<body>
    <div class="auth-page" style="background-color: var(--accent-light);">

        <!-- Geometric Pop Shapes for Login (BEHIND content) -->
        <div class="pop-shape shape-square"
            style="width: 100px; height: 100px; top: 15%; left: 5%; transform: rotate(-10deg); background: #feca57; z-index: 1;">
        </div>
        <div class="pop-shape shape-circle"
            style="width: 80px; height: 80px; bottom: 20%; left: 10%; background: #00bfff; z-index: 1;"></div>

        <!-- Left Side - Welcome -->
        <div class="auth-left" style="background: transparent; border-right: none;">
            <!-- Remove gradient, make transparent -->
            <a href="index.html" class="logo">
                <div class="logo-icon">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path
                            d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" />
                    </svg>
                </div>
                <span>EWU Matrimony</span>
            </a>

            <div class="auth-welcome">
                <h2>Welcome Back!</h2>
                <p>Continue your journey to find your perfect life partner from the EWU community.</p>

                <div class="auth-features"
                    style="display: flex; flex-direction: column; gap: 24px; position: relative; z-index: 20;">
                    <div class="auth-feature" style="display: flex; align-items: center; gap: 16px;">
                        <div class="auth-feature-icon"
                            style="width: 50px; height: 50px; min-width: 50px; background: white; border: 3px solid black; border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 3px 3px 0 black;">
                            <svg viewBox="0 0 24 24" fill="black" style="width: 24px; height: 24px;">
                                <path
                                    d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z" />
                            </svg>
                        </div>
                        <span style="font-weight: 700; color: black;">100% Secure & Private</span>
                    </div>
                    <div class="auth-feature" style="display: flex; align-items: center; gap: 16px;">
                        <div class="auth-feature-icon"
                            style="width: 50px; height: 50px; min-width: 50px; background: white; border: 3px solid black; border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 3px 3px 0 black;">
                            <svg viewBox="0 0 24 24" fill="black" style="width: 24px; height: 24px;">
                                <path
                                    d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm-2 16l-4-4 1.41-1.41L10 14.17l6.59-6.59L18 9l-8 8z" />
                            </svg>
                        </div>
                        <span style="font-weight: 700; color: black;">EWU Email Verified Profiles</span>
                    </div>
                    <div class="auth-feature" style="display: flex; align-items: center; gap: 16px;">
                        <div class="auth-feature-icon"
                            style="width: 50px; height: 50px; min-width: 50px; background: white; border: 3px solid black; border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 3px 3px 0 black;">
                            <svg viewBox="0 0 24 24" fill="black" style="width: 24px; height: 24px;">
                                <path
                                    d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" />
                            </svg>
                        </div>
                        <span style="font-weight: 700; color: black;">500+ Success Stories</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Right Side - Login Form -->
        <div class="auth-right">
            <div class="auth-form-container">
                <div class="auth-form-header">
                    <h1>Login</h1>
                    <p>Welcome back! Please enter your details.</p>
                </div>

                <form id="loginForm" action="#" method="POST">
                    <div class="form-group">
                        <label class="form-label" for="studentId">EWU Student ID</label>
                        <div class="input-with-icon">
                            <span class="input-icon">
                                <svg viewBox="0 0 24 24" fill="currentColor">
                                    <path
                                        d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" />
                                </svg>
                            </span>
                            <input type="text" id="studentId" name="student_id" class="form-input"
                                placeholder="e.g. 2024-1-60-123" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="password">Password</label>
                        <div class="input-with-icon">
                            <span class="input-icon">
                                <svg viewBox="0 0 24 24" fill="currentColor">
                                    <path
                                        d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z" />
                                </svg>
                            </span>
                            <input type="password" id="password" name="password" class="form-input"
                                placeholder="Enter your password" required>
                            <button type="button" class="password-toggle" onclick="togglePasswordVisibility()">
                                <svg id="eyeIcon" viewBox="0 0 24 24" width="20" height="20" fill="currentColor">
                                    <path
                                        d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z" />
                                </svg>
                            </button>
                        </div>
                    </div>

                    <div class="form-helper">
                        <label class="checkbox-label">
                            <input type="checkbox" name="remember">
                            Remember me
                        </label>
                        <a href="#" class="forgot-link">Forgot password?</a>
                    </div>

                    <button type="submit" class="btn btn-primary btn-block btn-lg">
                        Login
                    </button>
                </form>

                <div class="auth-divider">
                    <span>or continue with</span>
                </div>

                <div class="social-buttons">
                    <button class="btn-social">
                        <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor">
                            <path
                                d="M21.35 11.1h-9.17v2.73h6.51c-.33 3.81-3.5 5.44-6.5 5.44C8.36 19.27 5 16.25 5 12c0-4.1 3.2-7.27 7.2-7.27 3.09 0 4.9 1.97 4.9 1.97L19 4.72S16.56 2 12.1 2C6.42 2 2.03 6.8 2.03 12c0 5.05 4.13 10 10.22 10 5.35 0 9.25-3.67 9.25-9.09 0-1.15-.15-1.81-.15-1.81z" />
                        </svg>
                        Google
                    </button>
                    <button class="btn-social">
                        <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor">
                            <path
                                d="M22 12c0-5.52-4.48-10-10-10S2 6.48 2 12c0 4.84 3.44 8.87 8 9.8V15H8v-3h2V9.5C10 7.57 11.57 6 13.5 6H16v3h-2c-.55 0-1 .45-1 1v2h3v3h-3v6.95c5.05-.5 9-4.76 9-9.95z" />
                        </svg>
                        Facebook
                    </button>
                </div>

                <p class="auth-footer">
                    Don't have an account? <a href="register.html">Sign up for free</a>
                </p>
            </div>
        </div>
    </div>

    <script src="components.js"></script>
    <script src="script.js"></script>
    <script>
        // Simple password toggle function
        function togglePasswordVisibility() {
            const passwordInput = document.getElementById('password');
            const eyeIcon = document.getElementById('eyeIcon');

            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                eyeIcon.innerHTML = '<path d="M11.83 9L15 12.16V12a3 3 0 0 0-3-3h-.17m-4.3.8l1.55 1.55c-.05.21-.08.42-.08.65a3 3 0 0 0 3 3c.22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53a5 5 0 0 1-5-5c0-.79.2-1.53.53-2.2M2 4.27l2.28 2.28.45.45C3.08 8.3 1.78 10 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.43.42L19.73 22 21 20.73 3.27 3M12 7a5 5 0 0 1 5 5c0 .64-.13 1.26-.36 1.82l2.93 2.93c1.5-1.25 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-4 .7l2.17 2.15C10.74 7.13 11.35 7 12 7z"/>';
            } else {
                passwordInput.type = 'password';
                eyeIcon.innerHTML = '<path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>';
            }
        }

        // DOMContentLoaded for form handling
        document.addEventListener('DOMContentLoaded', function () {
            // Clear any existing session
            localStorage.removeItem('student_id');
            localStorage.removeItem('is_logged_in');

            const toggleBtn = document.querySelector('.password-toggle');
            const passwordInput = document.getElementById('password');

            if (toggleBtn && passwordInput) {
                toggleBtn.addEventListener('click', function (e) {
                    e.preventDefault();
                    if (passwordInput.type === 'password') {
                        passwordInput.type = 'text';
                        this.innerHTML = '<svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor"><path d="M11.83 9L15 12.16V12a3 3 0 0 0-3-3h-.17m-4.3.8l1.55 1.55c-.05.21-.08.42-.08.65a3 3 0 0 0 3 3c.22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53a5 5 0 0 1-5-5c0-.79.2-1.53.53-2.2M2 4.27l2.28 2.28.45.45C3.08 8.3 1.78 10 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.43.42L19.73 22 21 20.73 3.27 3M12 7a5 5 0 0 1 5 5c0 .64-.13 1.26-.36 1.82l2.93 2.93c1.5-1.25 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-4 .7l2.17 2.15C10.74 7.13 11.35 7 12 7z"/></svg>';
                    } else {
                        passwordInput.type = 'password';
                        this.innerHTML = '<svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor"><path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>';
                    }
                });
            }

            // Login form handling
            const loginForm = document.getElementById('loginForm');
            if (loginForm) {
                loginForm.addEventListener('submit', async function (e) {
                    e.preventDefault();

                    const studentId = document.getElementById('studentId').value.trim();
                    const password = document.getElementById('password').value;

                    if (!studentId || !password) {
                        Toast.warning('Missing Fields', 'Please fill in all fields');
                        return;
                    }

                    const submitBtn = this.querySelector('button[type="submit"]');
                    submitBtn.innerHTML = 'Logging in...';
                    submitBtn.disabled = true;

                    const formData = new FormData();
                    formData.append('studentId', studentId);
                    formData.append('password', password);

                    try {
                        const response = await fetch('api/auth?action=login', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ student_id: studentId, password: password })
                        });

                        const result = await response.json();

                        if (result.success) {
                            localStorage.setItem('student_id', studentId);
                            localStorage.setItem('is_logged_in', 'true');
                            Toast.success('Welcome Back!', 'Login successful. Redirecting...');
                            setTimeout(() => window.location.href = 'profile.html', 1500);
                        } else {
                            if (result.locked) {
                                Toast.error('Account Locked', result.message);
                            } else if (result.status === 'pending') {
                                Toast.warning('Pending Verification', result.message);
                            } else if (result.status === 'rejected') {
                                Toast.error('Account Rejected', result.message);
                            } else {
                                Toast.error('Login Failed', result.message);
                            }
                            submitBtn.innerHTML = 'Login';
                            submitBtn.disabled = false;
                        }
                    } catch (error) {
                        console.error('Error:', error);
                        Toast.error('Connection Error', 'Please check your internet connection');
                        submitBtn.innerHTML = 'Login';
                        submitBtn.disabled = false;
                    }
                });
            }
        });
    </script>
</body>

</html>